<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyze Whole Room Indirect Calorimetery (WRIC) Data • wrictools</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Analyze Whole Room Indirect Calorimetery (WRIC) Data">
<meta name="description" content="Description: Provides functions, tutorials, and examples to preprocess, analyze, and visualize data from whole room indirect calorimeters (WRIC) by Maastricht Instruments, using the OmniCal software. Some functions may also work with WRICs from other manufacturers, though full functionality has only been validated for Maastricht Instruments devices.">
<meta property="og:description" content="Description: Provides functions, tutorials, and examples to preprocess, analyze, and visualize data from whole room indirect calorimeters (WRIC) by Maastricht Instruments, using the OmniCal software. Some functions may also work with WRICs from other manufacturers, though full functionality has only been validated for Maastricht Instruments devices.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">wrictools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/wrictools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/RedCAP.html">RedCAP</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NinaZiegenbein/wrictools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="wrictools">wrictools<a class="anchor" aria-label="anchor" href="#wrictools"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This package provides functions, tutorials, and examples to preprocess, analyze, and visualize data from whole room indirect calorimeters (WRIC) by Maastricht Instruments, using the ‘OmniCal’ software. Some functions may also work with WRICs from other manufacturers, though full functionality has only been validated for Maastricht Instruments devices.</p>
<p>If you instead want to use the functions in Python, please click below. Please note, that the Python code will not be further maintained as of March 2025. <a href="https://github.com/hulmanlab/wrictools/blob/main/README.python.md" class="external-link"><img src="https://img.shields.io/badge/Python-yellow.svg" alt="pt-br"></a></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span></code></pre></div>
<p>If instead you want to install <code>wrictools</code> from GitHub use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span> <span class="st">"NinaZiegenbein/wrictools"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<div class="section level3">
<h3 id="preprocess-local-wric-files">Preprocess Local WRIC file(s)<a class="anchor" aria-label="anchor" href="#preprocess-local-wric-files"></a>
</h3>
<p>If you have a WRIC text file locally and want to preprocess it, the workflow involves reading the metadata at the top of the file, extracting the raw measurements into a structured CSV format, and trimming the dataset to only include rows between the specified study start and end times. Additional steps include adding a relative time variable, combining the two measurement streams, and optionally splitting the data by room (room1 and room2) before saving the final output as a CSV file. Many of these steps are parameter-controlled, allowing you to choose which actions to apply during preprocessing.</p>
<p><em>Note: The data.txt in the /data folder is synthetic data intended to highlight the data pipeline, but should not be used for actual analysis as it is unphysiological and does not correlate to the note.txt file either!</em></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NinaZiegenbein/wrictools" class="external-link">wrictools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data_no_comment.txt"</span>, package <span class="op">=</span> <span class="st">"wrictools"</span><span class="op">)</span> <span class="co"># loading example data</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/preprocess_WRIC_file.html">preprocess_wric_file</a></span><span class="op">(</span><span class="va">data_txt</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Rows: 4 Columns: 67</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: "\t"</span></span>
<span><span class="co">#&gt; chr   (4): X1, X18, X35, X52</span></span>
<span><span class="co">#&gt; dbl  (56): X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16, X2...</span></span>
<span><span class="co">#&gt; lgl   (3): X17, X34, X51</span></span>
<span><span class="co">#&gt; time  (4): X2, X19, X36, X53</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>The above code specifies only the necessary parameter <code>filepath</code> and assumes the default values for all other parameters. But you can specify these parameters for yourself, as can be seen below. As these are the default options the two function calls return exactly the same results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/preprocess_WRIC_file.html">preprocess_wric_file</a></span><span class="op">(</span></span>
<span>    <span class="va">data_txt</span>, </span>
<span>    code<span class="op">=</span><span class="st">"id"</span>, </span>
<span>    manual<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>    save_csv<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>    path_to_save<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>    combine<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>    method<span class="op">=</span><span class="st">"mean"</span>,</span>
<span>    start<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    end<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    notefilepath<span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    keywords_dict<span class="op">=</span><span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4 Columns: 67</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: "\t"</span></span>
<span><span class="co">#&gt; chr   (4): X1, X18, X35, X52</span></span>
<span><span class="co">#&gt; dbl  (56): X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16, X2...</span></span>
<span><span class="co">#&gt; lgl   (3): X17, X34, X51</span></span>
<span><span class="co">#&gt; time  (4): X2, X19, X36, X53</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>Here are explanations and options to all parameters you can specify:</p>
<ul>
<li>
<strong>filepath:</strong> [String, filepath] Directory path to the WRIC .txt file.</li>
<li>
<strong>code</strong> [String] Method for generating subject IDs. Default is “id”, also possible to specify “id+comment”, where both ID and comment values are combined or “manual”, where you can specify your own.</li>
<li>
<strong>manual</strong> [String] Custom codes for subjects in Room 1 and Room 2 if <code>code</code> is “manual”.</li>
<li>
<strong>save_csv</strong> [Logical], whether to save extracted metadata and data to CSV files or not. Default is False</li>
<li>
<strong>path_to_save</strong> [String] Directory path for saving CSV files, NULL uses the current directory, NULL is Default.</li>
<li>
<strong>combine</strong> [Logical], whether to combine S1 and S2 measurements. Default is True</li>
<li>
<strong>method</strong> [String] Method for combining measurements (“mean”, “median”, “s1”, “s2”, “min”, “max”).</li>
<li>
<strong>start</strong> [character or POSIXct or NULL], rows before this will be removed, if NULL takes first row e.g “2023-11-13 11:43:00”</li>
<li>
<strong>end</strong> [character or POSIXct or NULL], rows after this will be removed, if NULL takes last rows e.g “2023-11-13 11:43:00”</li>
<li>
<strong>notefilepath:</strong> If you specify a path to the corresponding notefile, the code will try to automatically extract the datetime and current protocol specification (sleeping, exercising, eating etc). If possible please read the <a href="https://github.com/hulmanlab/wrictools/blob/main/HowToNoteFile.pdf" class="external-link">How To Note File</a>, before you start your study for consistent note taking. If there is a TimeStamp in the note e.g “Participants starts eating at 16:10”, the time of the creation of the note will be overwritten with the time specified in the free-text of the note. The “protocol” is extracted by keyword search. You can check currently included keywords and extend them by checking the keywords_dict in the extract_note_info() function of the preprocessing.R file.</li>
<li>
<strong>keywords_dict:</strong> [Nested List] A “dictionary” with keywords for extracting protocol information out of the notefile.</li>
</ul>
<p>The function returns a list with <code>R1_metadata</code>, <code>R2_metadata</code>, <code>df_room1</code> and <code>df_room2</code>. Each item of the list is a DataFrame of either the metadata or the preprocessed actual data for either room 1 or 2. If <code>save_csv</code> is True, then the DataFrames will be saved as csv files with “id_visit_WRIC_data.csv” or “id_visit_WRIC_metadata.csv”.</p>
<p>As this is probably the most important function I have explained this here in length. But you can always run</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">preprocess_wric_file</span></span></code></pre></div>
<p>to get the description, parameters, return values and examples of how to use the function or any other function within the package.</p>
<p>For a more detailed tutorial on how to use the package, please look at vignette <code>wrictools</code>.</p>
</div>
<div class="section level3">
<h3 id="preprocess-multiple-files-on-redcap">Preprocess multiple files on RedCap<a class="anchor" aria-label="anchor" href="#preprocess-multiple-files-on-redcap"></a>
</h3>
<p>If you want to preprocess multiple WRIC files stored on a REDCap server, you can supply a CSV file containing the record IDs of interest. The function will automatically fetch the corresponding raw WRIC data, preprocess it, and return the results.</p>
<p>To connect to your REDCap project, you need your API token and the API URL for your instance. These should be stored in a local file (for example ~/.config.R) and sourced when you run the function. A minimal config file looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">api_token</span> <span class="op">&lt;-</span> <span class="st">'123C09E18E747592A693467A304EA32'</span></span>
<span><span class="va">api_url</span>   <span class="op">&lt;-</span> <span class="st">'https://redcap.au.dk/api/'</span> <span class="co">#change this url to your RedCAP url (e.g. 'https://redcap.wustl.edu/')</span></span></code></pre></div>
<details><summary><strong>Get your API Token for RedCap</strong>
</summary><ul>
<li>Go to your project and click on <strong>API</strong> in the menu on the left-hand side.<br>
</li>
<li>If you cannot find the API option, adjust your rights under <strong>User Rights</strong> (or ask the project creator).<br>
</li>
<li>Request the generation of an API Token.<br>
</li>
<li>Once approved, you’ll find your Token in the same place.</li>
</ul></details><p>⚠️ <strong>Important:</strong> Keep your token private and never share or commit it to version control. If working with sensitive data, consider removing the token from your config file after use.</p>
<p>You also need to specify the field name of the REDCap instrument where the raw WRIC data is stored (e.g. “wric_data”) and provide the CSV with record IDs (one per row, no headers or extra text). The record IDs must exactly match those used in REDCap.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load your REDCap credentials</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/path.expand.html" class="external-link">path.expand</a></span><span class="op">(</span><span class="st">"~/.config.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This creates a temporary csv file with record ID's</span></span>
<span><span class="va">tmp_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="va">tmp_csv</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preprocess WRIC files</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/preprocess_WRIC_files.html">preprocess_wric_files</a></span><span class="op">(</span></span>
<span>  csv_file   <span class="op">=</span> <span class="va">tmp_csv</span>,</span>
<span>  fieldname  <span class="op">=</span> <span class="st">"wric_data"</span>,</span>
<span>  api_url    <span class="op">=</span> <span class="va">api_url</span>,</span>
<span>  api_token  <span class="op">=</span> <span class="va">api_token</span>,</span>
<span>  save_csv   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  combine    <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method     <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The function returns a list, where each element corresponds to one record ID. Each record ID contains its own metadata and preprocessed data frames for room1 and room2.</p>
</div>
</div>
<div class="section level2">
<h2 id="other-good-to-know-functions">Other good-to-know functions<a class="anchor" aria-label="anchor" href="#other-good-to-know-functions"></a>
</h2>
<p>Remember that you can learn more about each function and it’s usage by <code>?function_name</code>.</p>
<ul>
<li>
<code>upload_file_to_redcap</code> to upload data to RedCAP</li>
<li>
<code>visualize_with_protocol</code>to visualize your data including highlights of the protocol</li>
<li>
<code>cut_rows</code> to cut your dataframe to certain timepoints</li>
<li>
<code>check-discrepancies</code>to check the difference between the two sensors within a chamber</li>
</ul>
</div>
<div class="section level2">
<h2 id="support-maintenance-and-future-work">Support, Maintenance and Future Work<a class="anchor" aria-label="anchor" href="#support-maintenance-and-future-work"></a>
</h2>
<p>For any issues, questions, or suggestions feel free to open an issue on GitHub or reach out to Nina Ziegenbein at <a href="mailto:ninzie@ph.au.dk" class="email">ninzie@ph.au.dk</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NinaZiegenbein/wrictools/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/NinaZiegenbein/wrictools/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing wrictools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nina Ziegenbein <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0009-0005-4913-8910" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NinaZiegenbein/wrictools/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/NinaZiegenbein/wrictools/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nina Ziegenbein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
