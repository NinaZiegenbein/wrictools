<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Processing, Analysis and Visualization of Whole Room Indirect Calorimetery Data • wrictools</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Processing, Analysis and Visualization of Whole Room Indirect Calorimetery Data">
<meta name="description" content="Description: Provides functions, tutorials, and examples to preprocess, analyze, and visualize data from whole room indirect calorimeters (WRIC) by Maastricht Instruments, using the OmniCal software. Some functions may also work with WRICs from other manufacturers, though full functionality has only been validated for Maastricht Instruments devices.">
<meta property="og:description" content="Description: Provides functions, tutorials, and examples to preprocess, analyze, and visualize data from whole room indirect calorimeters (WRIC) by Maastricht Instruments, using the OmniCal software. Some functions may also work with WRICs from other manufacturers, though full functionality has only been validated for Maastricht Instruments devices.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">wrictools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/wrictools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/RedCAP.html">RedCAP</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NinaZiegenbein/wrictools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="wrictools">wrictools<a class="anchor" aria-label="anchor" href="#wrictools"></a>
</h1></div>
<!-- badges: start -->

<p>This repository contains functions, tutorials and examples to (pre)process and analyse the data from the whole room indirect calorimeter by Maastricht Instruments using the OmniCal software.</p>
<p>If you instead want to use the functions in Python, please click below. Please note, that the Python code will not be further maintained as of March 03.2024.</p>
<p><a href="https://github.com/hulmanlab/wrictools/blob/main/README.python.md" class="external-link"><img src="https://img.shields.io/badge/Python-yellow.svg" alt="pt-br"></a></p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example which shows you how to solve a common problem:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NinaZiegenbein/wrictools" class="external-link">wrictools</a></span><span class="op">)</span></span>
<span><span class="co">## basic example code</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preprocess-local-wric-files">Preprocess Local WRIC file(s)<a class="anchor" aria-label="anchor" href="#preprocess-local-wric-files"></a>
</h2>
<p>If you have a WRIC (txt) file locally and want to preprocess it: That means reading the metadata at the top of the file, extracting the data from the txt format into a csv format, only including certain rows between start and end of the study, adding a relative time measurement, combining the two measurements, splitting by room1 and room2 and saving the data as a csv. Some of these actions are optional, so you can choose based on the parameters you provide.</p>
<p><em>Note: The data.txt in the example_data folder is random data in the same form and is just to highlight the data pipeline, but should not be used for actual analysis!</em></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data_no_comment.txt"</span>, package <span class="op">=</span> <span class="st">"wrictools"</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">preprocess_WRIC_file</span><span class="op">(</span><span class="va">data_txt</span><span class="op">)</span></span>
<span><span class="va">R1_metadata</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">R1_metadata</span></span>
<span><span class="va">R2_metadata</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">R2_metadata</span></span>
<span><span class="va">df_room1</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">df_room1</span></span>
<span><span class="va">df_room2</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">df_room2</span></span></code></pre></div>
<p>The above code specifies only the necessary parameter “filepath” and assumes the default values for all other parameters. But you can specify these parameters for yourself, as can be seen below. As these are the default options the two function calls return exactly the same results.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">preprocess_WRIC_file</span><span class="op">(</span></span>
<span>    <span class="va">data_txt</span>, </span>
<span>    code<span class="op">=</span><span class="st">"id"</span>, </span>
<span>    manual<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>    save_csv<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>    path_to_save<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>    combine<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>    method<span class="op">=</span><span class="st">"mean"</span>,</span>
<span>    start<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    end<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    notefilepath<span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    keywords_dict<span class="op">=</span><span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here are explanations and options to all parameters you can specify: - <strong>filepath:</strong> [String, filepath] Directory path to the WRIC .txt file. - <strong>code</strong> [String] Method for generating subject IDs. Default is “id”, also possible to specify “id+comment”, where both ID and comment values are combined or “manual”, where you can specify your own. - <strong>manual</strong> [String] Custom codes for subjects in Room 1 and Room 2 if <code>code</code> is “manual”. - <strong>save_csv</strong> [Logical], whether to save extracted metadata and data to CSV files or not. Default is True - <strong>path_to_save</strong> [String] Directory path for saving CSV files, NULL uses the current directory, NULL is Deafult. - <strong>combine</strong> [Logical], whether to combine S1 and S2 measurements. Default is True - <strong>method</strong> [String] Method for combining measurements (“mean”, “median”, “s1”, “s2”, “min”, “max”). - <strong>start</strong> [character or POSIXct or NULL], rows before this will be removed, if NULL takes first row e.g “2023-11-13 11:43:00” - <strong>end</strong> [character or POSIXct or NULL], rows after this will be removed, if NULL takes last rows e.g “2023-11-13 11:43:00” - <strong>notefilepath:</strong> If you specify a path to the corresponding notefile, the code will try to automatically extract the datetime and current protocol specification (sleeping, exercising, eating etc). If possible please read the <a href="https://github.com/hulmanlab/wrictools/blob/main/HowToNoteFile.pdf" class="external-link">How To Note File</a>, before you start your study for consistent note taking. If there is a TimeStamp in the note e.g “Participants starts eating at 16:10”, the time of the creation of the note will be overwritten with the time specified in the free-text of the note. The “protocol” is extracted by keyword search. You can check currently included keywords and extend them by checking the keywords_dict in the extract_note_info() function of the preprocessing.R file. - <strong>keywords_dict:</strong> [Nested List] A “dictionary” with keywords for extracting protocol information out of the notefile.</p>
<p>The function returns a list with “R1_metadata”, “R2_metadata”, “df_room1” and “df_room2”. Each item of the list is a DataFrame of either the metadata or the preprocessed actual data for either room 1 or 2. If ´save_csv` is True, then the DataFrames will be saved as csv files with “id_visit_WRIC_data.csv” or “id_visit_WRIC_metadata.csv”.</p>
</div>
<div class="section level2">
<h2 id="preprocess-multiple-files-on-redcap">Preprocess multiple files on RedCap<a class="anchor" aria-label="anchor" href="#preprocess-multiple-files-on-redcap"></a>
</h2>
<p>If you want to preprocess multiple files and access them on the RedCap Server using a csv-file containing the record IDs:</p>
<p>To access the data on RedCap you first need to set up a <code>config.r</code> file. You can use the <code>config_example.r</code> as a template and input your personal API-Token to the repository with the data (see ‘Get your API Token for RedCap’ below). Make sure that if the config.r file stays locally and without anyone else having access to it. When handling sensitive data it might make sense to delete the token from the file after using it.</p>
<p>Besides setting up the config file, you need to specify the field-name of your RedCap instrument where the raw WRIC-data is located (in the example below the field is named “WRIC_raw”) and you need to provide the record IDs of the records that you want to access. They simply need to be written in a column with no further words or comments and need to match the record IDs on RedCap.</p>
<p><em>Please note that the code below will not work for you until you 1) set up the config file, 2) create a csv with record ids and change the file path, 3) write the correct field name of your project.</em></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">preprocess_WRIC_files</span><span class="op">(</span><span class="st">"./example_data/record_ids.csv"</span>, <span class="st">"WRIC_raw"</span>, code <span class="op">=</span> <span class="st">"id"</span>, manual <span class="op">=</span> <span class="cn">NULL</span>, save_csv <span class="op">=</span> <span class="va">True</span>, path_to_save <span class="op">=</span> <span class="cn">NULL</span>, combine <span class="op">=</span> <span class="va">True</span>, method <span class="op">=</span> <span class="st">"mean"</span>, start <span class="op">=</span> <span class="cn">NULL</span>, end <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">R1_metadata</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">R1_metadata</span></span>
<span><span class="va">R2_metadata</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">R2_metadata</span></span>
<span><span class="va">df_room1</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">df_room1</span></span>
<span><span class="va">df_room2</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">df_room2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-your-api-token-for-redcap">Get your API Token for RedCap<a class="anchor" aria-label="anchor" href="#get-your-api-token-for-redcap"></a>
</h2>
<ul>
<li>Go to your project and click on <strong>API</strong> in the menu on the left hand side
<ul>
<li>If you can not find the API option in the menu, you might have to adjust the rights to your project by clicking on <strong>User Rights</strong> and adjusting your API rights (or the creator of the project, if that is not you)</li>
</ul>
</li>
<li>You have to request the generation of an API Token (in my experience takes only a couple hours)</li>
<li>At the same place you can find your Token after your request has been approved and the token generated</li>
</ul>
</div>
<div class="section level2">
<h2 id="uploading-data-to-redcap">Uploading Data to RedCap<a class="anchor" aria-label="anchor" href="#uploading-data-to-redcap"></a>
</h2>
<p>You can use function <code>upload_file_to_redcap(filepath, record_id, fieldname)</code> to upload a file to a specific record and fieldname in RedCap. You need to have set-up your config file.</p>
</div>
</div>
<div class="section level1">
<h1 id="support-maintenance-and-future-work">Support, Maintenance and Future Work<a class="anchor" aria-label="anchor" href="#support-maintenance-and-future-work"></a>
</h1>
<p>For any issues, questions, or suggestions feel free to reach out to Nina Ziegenbein at <a href="mailto:nina.ziegenbein@rm.dk" class="email">nina.ziegenbein@rm.dk</a>.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NinaZiegenbein/wrictools/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/NinaZiegenbein/wrictools/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing wrictools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nina Ziegenbein <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0009-0005-4913-8910" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NinaZiegenbein/wrictools/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/NinaZiegenbein/wrictools/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nina Ziegenbein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
