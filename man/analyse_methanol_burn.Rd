% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis.R
\name{analyse_methanol_burn}
\alias{analyse_methanol_burn}
\title{Analyse methanol burn experiment}
\usage{
analyse_methanol_burn(
  filepath,
  methanolfilepath,
  room1 = TRUE,
  datetime_format = "\%d-\%m-\%y \%H:\%M",
  code = "id",
  manual = NULL,
  save_csv = FALSE,
  path_to_save = NULL,
  combine = TRUE,
  method = "mean",
  start = NULL,
  end = NULL,
  notefilepath = NULL,
  keywords_dict = NULL,
  entry_exit_dict = NULL
)
}
\arguments{
\item{filepath}{Path to the wric .txt file.}

\item{methanolfilepath}{File path to an Excel file with columns:
\describe{
\item{datetime}{Timestamp of measurement, format \code{\%d-\%m-\%y \%H:\%M} by default. Can override with \code{datetime_format}.}
\item{methanol}{Methanol mass (g) at each timestamp.}
}}

\item{room1}{Logical; if TRUE uses room1 data from WRIC file, else room2. This is only relevant for files generates by software version 1. Default is TRUE.}

\item{datetime_format}{Character; format string for parsing methanol datetime column. Default is "\%d-\%m-\%y \%H:\%M" (25-03-25 13:58).}

\item{code}{Method for generating subject IDs ("id", "id+comment", "study+id" (only for software v2), or "manual").}

\item{manual}{Custom codes for subjects in Room 1 and Room 2 if \code{code} is "manual".}

\item{save_csv}{Logical, whether to save extracted metadata and data to CSV files.}

\item{path_to_save}{Directory path for saving CSV files, NULL uses the current directory.}

\item{combine}{Logical, whether to combine S1 and S2 measurements.}

\item{method}{Method for combining measurements ("mean", "median", "s1", "s2", "min", "max").}

\item{start}{character or POSIXct or NULL, rows before this will be removed, if NULL takes first row e.g "2023-11-13 11:43:00"}

\item{end}{character or POSIXct or NULL, rows after this will be removed, if NULL takes last row e.g "2023-11-13 11:43:00"}

\item{notefilepath}{String, Directory path of the corresponding note file (.txt)}

\item{keywords_dict}{list, optional
A dictionary of keywords used to extract protocol events from a note file. Each entry should be a named list with:
\describe{
\item{keywords}{A character vector of keywords or phrases to match in the note comment. Matching is case-insensitive.}
\item{value}{Numeric protocol value to assign when the keyword is detected.}
\item{type}{Optional character, either "instant" or omitted. "instant" events are applied at the specified timestamp and revert to the previous protocol immediately after. Non-instant events set the protocol until another event occurs.}
}
Behavior rules:
\describe{
\item{Non-instant events}{Set the protocol value from their timestamp until another event overwrites it or until a stop keyword sets it to 0.}
\item{Instant events}{Apply only at the timestamp of the note line, then revert to the protocol that was active immediately before.}
\item{Stop keywords}{Always set the protocol to 0, regardless of previous state, unless overridden by an instant event.}
}
If \code{NULL}, a default set of keywords is used.}

\item{entry_exit_dict}{Nested List, used to extract entry/exit times from note file}
}
\value{
A list with:
\describe{
\item{per_interval}{Data frame with per-timestep methanol burn, predicted CO2/O2, measured VO2/VCO2, deviations, RER}
\item{overall}{Summary for the whole session}
\item{plots}{List of ggplot objects (values shown correspond to the end of each interval)}
}
}
\description{
Analyse methanol burn experiment
}
\examples{
\dontshow{if (file.exists(path.expand("~/methanol.xlsx"))) withAutoprint(\{ # examplesIf}
methanol <- source(path.expand("~/methanol.xlsx"))
data_txt <- system.file("extdata", "data.txt", package = "wrictools")
analyse_methanol_burn (data_txt, methanol, room1 = FALSE)
\dontshow{\}) # examplesIf}
}
