% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/processing.R
\name{extract_note_info_new}
\alias{extract_note_info_new}
\title{Apply protocol events from note files to a single room data frame (new software)}
\usage{
extract_note_info_new(df, notes_path, keywords_dict = NULL)
}
\arguments{
\item{df}{data.frame
Data frame containing at least a "datetime" column.}

\item{notes_path}{character
Path to the note file containing protocol events.}

\item{keywords_dict}{list, optional
A dictionary of keywords used to extract protocol events from a note file. Each entry should be a named list with:
\describe{
\item{keywords}{A character vector of keywords or phrases to match in the note comment. Matching is case-insensitive.}
\item{value}{Numeric protocol value to assign when the keyword is detected.}
\item{type}{Optional character, either "instant" or omitted. "instant" events are applied at the specified timestamp and revert to the previous protocol immediately after. Non-instant events set the protocol until another event occurs.}
}
Behavior rules:
\describe{
\item{Non-instant events}{Set the protocol value from their timestamp until another event overwrites it or until a stop keyword sets it to 0.}
\item{Instant events}{Apply only at the timestamp of the note line, then revert to the protocol that was active immediately before.}
\item{Stop keywords}{Always set the protocol to 0, regardless of previous state, unless overridden by an instant event.}
}
If \code{NULL}, a default set of keywords is used.}
}
\value{
data.frame
The input data frame with an updated "protocol" column based on extracted events.
}
\description{
Reads a note file, extracts protocol events, applies any detected time drift,
and updates the protocol column in the provided data frame. Designed for notes
generated by the newer software version where all participants are in a single data frame.
}
\examples{
df <- data.frame(datetime = as.POSIXct(c("2023-11-13 22:40:00", "2023-11-13 22:50:00")))
note_file <- system.file("extdata", "note_v2.txt", package = "wrictools")
df_updated <- extract_note_info_new(df, note_file)
df_updated
}
